"use strict";
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
exports.__esModule = true;
var react_1 = __importDefault(require("react"));
var regexp = /^\/([a-z0-9]+) (.*)$/;
var Input = /** @class */ (function (_super) {
    __extends(Input, _super);
    function Input() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.textArea = react_1["default"].createRef();
        _this.state = {
            message: ''
        };
        _this.handleChange = function (event) {
            _this.setState({
                message: event.target.value
            });
        };
        _this.handleSubmit = function (e) {
            e.preventDefault();
            _this.submit();
        };
        _this.handleKeyPress = function (e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                _this.submit();
            }
        };
        _this.handleSmileClick = function (event) {
            _this.setState({
                message: _this.textArea.current.value + event.currentTarget.innerHTML
            });
        };
        _this.submit = function () {
            var sendMessage = _this.props.sendMessage;
            var message = _this.state.message;
            if (message) {
                var matches = regexp.exec(message);
                var command = matches && matches[1];
                var restOfMessage = matches && matches[2] || '';
                switch (command) {
                    case 'nick':
                        sendMessage({
                            type: 'nickname',
                            payload: { nickname: restOfMessage }
                        });
                        break;
                    default:
                        sendMessage({
                            payload: message,
                            type: 'text'
                        });
                }
                // let image = null
                // // take snapshoot
                // try {
                //   const video = videos[userId]
                //   if (video) {
                //     const canvas = document.createElement('canvas')
                //     canvas.height = video.videoHeight
                //     canvas.width = video.videoWidth
                //     const avatar = canvas.getContext('2d')
                //     avatar.drawImage(video, 0, 0, canvas.width, canvas.height)
                //     image = canvas.toDataURL()
                //   }
                // } catch (e) {}
            }
            _this.setState({ message: '' });
        };
        return _this;
    }
    Input.prototype.render = function () {
        var message = this.state.message;
        return (react_1["default"].createElement("form", { className: "chat-controls", onSubmit: this.handleSubmit },
            react_1["default"].createElement("textarea", { className: "chat-controls-textarea", onChange: this.handleChange, onKeyPress: this.handleKeyPress, placeholder: "Type a message", value: message, ref: this.textArea }),
            react_1["default"].createElement("div", { className: "chat-controls-buttons" },
                react_1["default"].createElement("input", { type: "submit", value: "Send", className: "chat-controls-buttons-send" }),
                react_1["default"].createElement("div", { className: "chat-controls-buttons-wrapper" },
                    react_1["default"].createElement("div", { className: "emoji" },
                        react_1["default"].createElement("div", { className: "chat-controls-buttons-smiles" },
                            react_1["default"].createElement("span", { className: "icon icon-sentiment_satisfied" }),
                            react_1["default"].createElement("div", { className: "chat-controls-buttons-smiles-menu" },
                                react_1["default"].createElement("div", { className: "chat-controls-buttons-smile", onClick: this.handleSmileClick }, "\uD83D\uDE11"),
                                react_1["default"].createElement("div", { className: "chat-controls-buttons-smile", onClick: this.handleSmileClick }, "\uD83D\uDE15"),
                                react_1["default"].createElement("div", { className: "chat-controls-buttons-smile", onClick: this.handleSmileClick }, "\uD83D\uDE0A"),
                                react_1["default"].createElement("div", { className: "chat-controls-buttons-smile", onClick: this.handleSmileClick }, "\uD83D\uDE0E"),
                                react_1["default"].createElement("div", { className: "chat-controls-buttons-smile", onClick: this.handleSmileClick }, "\uD83D\uDCAA"))))))));
    };
    return Input;
}(react_1["default"].PureComponent));
exports["default"] = Input;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSW5wdXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY2xpZW50L2NvbXBvbmVudHMvSW5wdXQudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLGdEQUE2RztBQVc3RyxJQUFNLE1BQU0sR0FBRyxzQkFBc0IsQ0FBQTtBQUVyQztJQUFtQyx5QkFBMkM7SUFBOUU7UUFBQSxxRUFxR0M7UUFwR0MsY0FBUSxHQUFHLGtCQUFLLENBQUMsU0FBUyxFQUF1QixDQUFBO1FBQ2pELFdBQUssR0FBRztZQUNOLE9BQU8sRUFBRSxFQUFFO1NBQ1osQ0FBQTtRQUNELGtCQUFZLEdBQTRDLFVBQUEsS0FBSztZQUMzRCxLQUFJLENBQUMsUUFBUSxDQUFDO2dCQUNaLE9BQU8sRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUs7YUFDNUIsQ0FBQyxDQUFBO1FBQ0osQ0FBQyxDQUFBO1FBQ0Qsa0JBQVksR0FBdUMsVUFBQSxDQUFDO1lBQ2xELENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQTtZQUNsQixLQUFJLENBQUMsTUFBTSxFQUFFLENBQUE7UUFDZixDQUFDLENBQUE7UUFDRCxvQkFBYyxHQUE4QyxVQUFBLENBQUM7WUFDM0QsSUFBSSxDQUFDLENBQUMsR0FBRyxLQUFLLE9BQU8sSUFBSSxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUU7Z0JBQ3BDLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQTtnQkFDbEIsS0FBSSxDQUFDLE1BQU0sRUFBRSxDQUFBO2FBQ2Q7UUFDSCxDQUFDLENBQUE7UUFDRCxzQkFBZ0IsR0FBbUMsVUFBQSxLQUFLO1lBQ3RELEtBQUksQ0FBQyxRQUFRLENBQUM7Z0JBQ1osT0FBTyxFQUFFLEtBQUksQ0FBQyxRQUFRLENBQUMsT0FBUSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsYUFBYSxDQUFDLFNBQVM7YUFDdEUsQ0FBQyxDQUFBO1FBQ0osQ0FBQyxDQUFBO1FBQ0QsWUFBTSxHQUFH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bGVyLCBLZXlib2FyZEV2ZW50SGFuZGxlciwgTW91c2VFdmVudEhhbmRsZXIgfSBmcm9tICdyZWFjdCdcbmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICcuLi9hY3Rpb25zL1BlZXJBY3Rpb25zJ1xuXG5leHBvcnQgaW50ZXJmYWNlIElucHV0UHJvcHMge1xuICBzZW5kTWVzc2FnZTogKG1lc3NhZ2U6IE1lc3NhZ2UpID0+IHZvaWRcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbnB1dFN0YXRlIHtcbiAgbWVzc2FnZTogc3RyaW5nXG59XG5cbmNvbnN0IHJlZ2V4cCA9IC9eXFwvKFthLXowLTldKykgKC4qKSQvXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIElucHV0IGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxJbnB1dFByb3BzLCBJbnB1dFN0YXRlPiB7XG4gIHRleHRBcmVhID0gUmVhY3QuY3JlYXRlUmVmPEhUTUxUZXh0QXJlYUVsZW1lbnQ+KClcbiAgc3RhdGUgPSB7XG4gICAgbWVzc2FnZTogJycsXG4gIH1cbiAgaGFuZGxlQ2hhbmdlOiBDaGFuZ2VFdmVudEhhbmRsZXI8SFRNTFRleHRBcmVhRWxlbWVudD4gPSBldmVudCA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBtZXNzYWdlOiBldmVudC50YXJnZXQudmFsdWUsXG4gICAgfSlcbiAgfVxuICBoYW5kbGVTdWJtaXQ6IFJlYWN0RXZlbnRIYW5kbGVyPEhUTUxGb3JtRWxlbWVudD4gPSBlID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICB0aGlzLnN1Ym1pdCgpXG4gIH1cbiAgaGFuZGxlS2V5UHJlc3M6IEtleWJvYXJkRXZlbnRIYW5kbGVyPEhUTUxUZXh0QXJlYUVsZW1lbnQ+ID0gZSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSAnRW50ZXInICYmICFlLnNoaWZ0S2V5KSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgIHRoaXMuc3VibWl0KClcbiAgICB9XG4gIH1cbiAgaGFuZGxlU21pbGVDbGljazogTW91c2VFdmVudEhhbmRsZXI8SFRNTEVsZW1lbnQ+ID0gZXZlbnQgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgbWVzc2FnZTogdGhpcy50ZXh0QXJlYS5jdXJyZW50IS52YWx1ZSArIGV2ZW50LmN1cnJlbnRUYXJnZXQuaW5uZXJIVE1MLFxuICAgIH0pXG4gIH1cbiAgc3VibWl0ID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgc2VuZE1lc3NhZ2UgfSA9IHRoaXMucHJvcHNcbiAgICBjb25zdCB7IG1lc3NhZ2UgfSA9IHRoaXMuc3RhdGVcbiAgICBpZiAobWVzc2FnZSkge1xuICAgICAgY29uc3QgbWF0Y2hlcyA9IHJlZ2V4cC5leGVjKG1lc3NhZ2UpXG4gICAgICBjb25zdCBjb21tYW5kID0gbWF0Y2hlcyAmJiBtYXRjaGVzWzFdXG4gICAgICBjb25zdCByZXN0T2ZNZXNzYWdlID0gbWF0Y2hlcyAmJiBtYXRjaGVzWzJdIHx8ICcnXG4gICAgICBzd2l0Y2ggKGNvbW1hbmQpIHtcbiAgICAgICAgY2FzZSAnbmljayc6XG4gICAgICAgICAgc2VuZE1lc3NhZ2Uoe1xuICAgICAgICAgICAgdHlwZTogJ25pY2tuYW1lJyxcbiAgICAgICAgICAgIHBheWxvYWQ6IHtuaWNrbmFtZTogcmVzdE9mTWVzc2FnZX0sXG4gICAgICAgICAgfSlcbiAgICAgICAgICBicmVha1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHNlbmRNZXNzYWdlKHtcbiAgICAgICAgICAgIHBheWxvYWQ6IG1lc3NhZ2UsXG4gICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIC8vIGxldCBpbWFnZSA9IG51bGxcblxuICAgICAgLy8gLy8gdGFrZSBzbmFwc2hvb3RcbiAgICAgIC8vIHRyeSB7XG4gICAgICAvLyAgIGNvbnN0IHZpZGVvID0gdmlkZW9zW3VzZXJJZF1cbiAgICAgIC8vICAgaWYgKHZpZGVvKSB7XG4gICAgICAvLyAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJylcbiAgICAgIC8vICAgICBjYW52YXMuaGVpZ2h0ID0gdmlkZW8udmlkZW9IZWlnaHRcbiAgICAgIC8vICAgICBjYW52YXMud2lkdGggPSB2aWRlby52aWRlb1dpZHRoXG4gICAgICAvLyAgICAgY29uc3QgYXZhdGFyID0gY2FudmFzLmdldENvbnRleHQoJzJkJylcbiAgICAgIC8vICAgICBhdmF0YXIuZHJhd0ltYWdlKHZpZGVvLCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpXG4gICAgICAvLyAgICAgaW1hZ2UgPSBjYW52YXMudG9EYXRhVVJMKClcbiAgICAgIC8vICAgfVxuICAgICAgLy8gfSBjYXRjaCAoZSkge31cbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7IG1lc3NhZ2U6ICcnIH0pXG4gIH1cbiAgcmVuZGVyICgpIHtcbiAgICBjb25zdCB7IG1lc3NhZ2UgfSA9IHRoaXMuc3RhdGVcbiAgICByZXR1cm4gKFxuICAgICAgPGZvcm0gY2xhc3NOYW1lPVwiY2hhdC1jb250cm9sc1wiIG9uU3VibWl0PXt0aGlzLmhhbmRsZVN1Ym1pdH0+XG4gICAgICAgIDx0ZXh0YXJlYVxuICAgICAgICAgIGNsYXNzTmFtZT1cImNoYXQtY29udHJvbHMtdGV4dGFyZWFcIlxuICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZUNoYW5nZX1cbiAgICAgICAgICBvbktleVByZXNzPXt0aGlzLmhhbmRsZUtleVByZXNzfVxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVHlwZSBhIG1lc3NhZ2VcIlxuICAgICAgICAgIHZhbHVlPXttZXNzYWdlfVxuICAgICAgICAgIHJlZj17dGhpcy50ZXh0QXJlYX1cbiAgICAgICAgLz5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjaGF0LWNvbnRyb2xzLWJ1dHRvbnNcIj5cbiAgICAgICAgICA8aW5wdXQgdHlwZT1cInN1Ym1pdFwiIHZhbHVlPVwiU2VuZFwiXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJjaGF0LWNvbnRyb2xzLWJ1dHRvbnMtc2VuZFwiIC8+XG5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNoYXQtY29udHJvbHMtYnV0dG9ucy13cmFwcGVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImVtb2ppXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2hhdC1jb250cm9scy1idXR0b25zLXNtaWxlc1wiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImljb24gaWNvbi1zZW50aW1lbnRfc2F0aXNmaWVkXCIgLz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNoYXQtY29udHJvbHMtYnV0dG9ucy1zbWlsZXMtbWVudVwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjaGF0LWNvbnRyb2xzLWJ1dHRvbnMtc21pbGVcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLmhhbmRsZVNtaWxlQ2xpY2t9PvCfmJE8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2hhdC1jb250cm9scy1idXR0b25zLXNtaWxlXCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVTbWlsZUNsaWNrfT7wn5iVPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNoYXQtY29udHJvbHMtYnV0dG9ucy1zbWlsZVwiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlU21pbGVDbGlja30+8J+YijwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjaGF0LWNvbnRyb2xzLWJ1dHRvbnMtc21pbGVcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLmhhbmRsZVNtaWxlQ2xpY2t9PvCfmI48L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2hhdC1jb250cm9scy1idXR0b25zLXNtaWxlXCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVTbWlsZUNsaWNrfT7wn5KqPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9mb3JtPlxuICAgIClcbiAgfVxufVxuIl19