"use strict";
exports.__esModule = true;
var readConfig_1 = require("./readConfig");
var fs_1 = require("fs");
var path_1 = require("path");
describe('Config', function () {
    var config = new readConfig_1.ReadConfig({
        a: 1,
        b: {
            c: 'test1',
            d: 'test2'
        }
    });
    describe('get', function () {
        it('reads config values recursively', function () {
            expect(config.get('a')).toBe(1);
            expect(config.get('b')).toEqual({ c: 'test1', d: 'test2' });
            expect(config.get('b.c')).toBe('test1');
            expect(config.get('b.d')).toBe('test2');
        });
        it('throws an error when key does not exist', function () {
            expect(function () { return config.get('e'); }).toThrowError(/does not exist/);
            expect(function () { return config.get('e.f'); }).toThrowError(/does not exist/);
        });
        it('returns a default value when provided', function () {
            expect(config.get('b.c', 'test')).toBe('test1');
            expect(config.get('e', 1)).toBe(1);
            expect(config.get('e.f', 2)).toBe(2);
        });
    });
    describe('has', function () {
        it('returns true when config property exists, false otherwise', function () {
            expect(config.has('a')).toBe(true);
            expect(config.has('b')).toBe(true);
            expect(config.has('b.c')).toBe(true);
            expect(config.has('b.d')).toBe(true);
            expect(config.has('e')).toBe(false);
            expect(config.has('e.f')).toBe(false);
        });
    });
});
describe('findPackageRoot', function () {
    var dir = path_1.join(__dirname, 'package.json');
    beforeEach(function () {
        if (fs_1.existsSync(dir)) {
            fs_1.rmdirSync(dir);
        }
        fs_1.mkdirSync(dir);
    });
    afterEach(function () {
        if (fs_1.existsSync(dir)) {
            fs_1.rmdirSync(dir);
        }
    });
    it('finds package root folder', function () {
        expect(readConfig_1.findPackageRoot()).toEqual(jasmine.any(String));
    });
    it('finds package root folder', function () {
        expect(readConfig_1.findPackageRoot(__dirname)).toEqual(jasmine.any(String));
    });
    it('throws an error when not found', function () {
        expect(function () { return readConfig_1.findPackageRoot('/tmp'); }).toThrowError();
    });
});
describe('getAllConfigFilesInDirectory', function () {
    it('returns default and local files', function () {
        var files = readConfig_1.getAllConfigFilesInDirectory('/test', undefined);
        expect(files).toEqual([
            '/test/default.yaml',
            '/test/local.yaml',
        ]);
    });
    it('returns default, environment, and local files', function () {
        var files = readConfig_1.getAllConfigFilesInDirectory('/test', 'test');
        expect(files).toEqual([
            '/test/default.yaml',
            '/test/test.yaml',
            '/test/local.yaml',
        ]);
    });
});
describe('getAllConfigLocations', function () {
    it('returns package and local dirs when separate', function () {
        var files = readConfig_1.getAllConfigLocations('/test1', '/test2', 'test');
        expect(files).toEqual([
            '/test1/default.yaml',
            '/test1/test.yaml',
            '/test1/local.yaml',
            '/test2/default.yaml',
            '/test2/test.yaml',
            '/test2/local.yaml',
        ]);
    });
    it('returns only package dir when local dir is same', function () {
        var files = readConfig_1.getAllConfigLocations('/test', '/test', 'test');
        expect(files).toEqual([
            '/test/default.yaml',
            '/test/test.yaml',
            '/test/local.yaml',
        ]);
    });
    it('adds an extra config file', function () {
        var files = readConfig_1.getAllConfigLocations('/test', '/test', 'test', '/test/test-extra.yaml');
        expect(files).toEqual([
            '/test/default.yaml',
            '/test/test.yaml',
            '/test/local.yaml',
            '/test/test-extra.yaml',
        ]);
    });
    it('does not add extra config file when it is the same', function () {
        var files = readConfig_1.getAllConfigLocations('/test', '/test', 'test', '/test/test.yaml');
        expect(files).toEqual([
            '/test/default.yaml',
            '/test/test.yaml',
            '/test/local.yaml',
        ]);
    });
});
describe('toSnakeCase', function () {
    it('converts uppercase, underscore-separated words to snake case', function () {
        expect(readConfig_1.toSnakeCase('TEST')).toBe('test');
        expect(readConfig_1.toSnakeCase('TEST_1')).toBe('test1');
        expect(readConfig_1.toSnakeCase('TEST_VALUE')).toBe('testValue');
        expect(readConfig_1.toSnakeCase('TEST_VALUE_TWO')).toBe('testValueTwo');
    });
});
describe('mergeConfig', function () {
    it('merges source config into destination', function () {
        var dest = {
            a: 1,
            b: [2],
            c: {
                d: 3
            }
        };
        expect(readConfig_1.mergeConfig({
            a: 4,
            b: { value: 5 },
            c: {
                e: 6
            }
        }, dest)).toEqual({
            a: 4,
            b: { value: 5 },
            c: {
                d: 3,
                e: 6
            }
        });
    });
});
describe('readConfig', function () {
    it('reads from a number of files', function () {
        var result = readConfig_1.readConfig();
        expect(result).toBeInstanceOf(readConfig_1.ReadConfig);
    });
    it('reads from an extra config file', function () {
    });
    describe('errors', function () {
        var dir = path_1.join(__dirname, 'test.dir');
        beforeEach(function () {
            fs_1.mkdirSync(dir);
        });
        afterEach(function () {
            fs_1.rmdirSync(dir);
        });
        it('fails on errors different than ENOENT', function () {
            expect(function () { return readConfig_1.readConfig(process.env, undefined, undefined, dir); }).toThrowError(/EISDIR/);
        });
    });
    it('does not fail when no config files found', function () {
        readConfig_1.readConfig({}, '/tmp', '/tmp');
    });
    it('reads values from environment variables', function () {
        var config = readConfig_1.readConfig({
            PEERCALLS__TEST_VALUE__SUB_VALUE_1: '1',
            PEERCALLS__TEST_VALUE__SUB_VALUE_2: JSON.stringify({ a: 2 }),
            PEERCALLS__TEST_VALUE__SUB_VALUE_3: 'string'
        }, '/tmp', '/tmp');
        expect(config.value()).toEqual({
            testValue: {
                subValue1: 1,
                subValue2: { a: 2 },
                subValue3: 'string'
            }
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVhZENvbmZpZy50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3NlcnZlci9yZWFkQ29uZmlnL3JlYWRDb25maWcudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDJDQUFxSjtBQUNySix5QkFBcUQ7QUFDckQsNkJBQTJCO0FBRTNCLFFBQVEsQ0FBQyxRQUFRLEVBQUU7SUFFakIsSUFBTSxNQUFNLEdBQUcsSUFBSSx1QkFBVSxDQUFDO1FBQzVCLENBQUMsRUFBRSxDQUFDO1FBQ0osQ0FBQyxFQUFFO1lBQ0QsQ0FBQyxFQUFFLE9BQU87WUFDVixDQUFDLEVBQUUsT0FBTztTQUNYO0tBQ0YsQ0FBQyxDQUFBO0lBRUYsUUFBUSxDQUFDLEtBQUssRUFBRTtRQUNkLEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRTtZQUNwQyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtZQUMvQixNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUE7WUFDekQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7WUFDdkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7UUFDekMsQ0FBQyxDQUFDLENBQUE7UUFDRixFQUFFLENBQUMseUNBQXlDLEVBQUU7WUFDNUMsTUFBTSxDQUFDLGNBQU0sT0FBQSxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFmLENBQWUsQ0FBQyxDQUFDLFlBQVksQ0FBQyxnQkFBZ0Is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LENBQUMsQ0FBQTtRQUNGLFNBQVMsQ0FBQztZQUNSLGNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUNoQixDQUFDLENBQUMsQ0FBQTtRQUNGLEVBQUUsQ0FBQyx1Q0FBdUMsRUFBRTtZQUMxQyxNQUFNLENBQUMsY0FBTSxPQUFBLHVCQUFVLENBQ3JCLE9BQU8sQ0FBQyxHQUFHLEVBQ1gsU0FBUyxFQUNULFNBQVMsRUFDVCxHQUFHLENBQ0osRUFMWSxDQUtaLENBQUMsQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUE7UUFDM0IsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDLENBQUMsQ0FBQTtJQUVGLEVBQUUsQ0FBQywwQ0FBMEMsRUFBRTtRQUM3Qyx1QkFBVSxDQUFDLEVBQUUsRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUE7SUFDaEMsQ0FBQyxDQUFDLENBQUE7SUFFRixFQUFFLENBQUMseUNBQXlDLEVBQUU7UUFDNUMsSUFBTSxNQUFNLEdBQUcsdUJBQVUsQ0FBQztZQUN4QixrQ0FBa0MsRUFBRSxHQUFHO1lBQ3ZDLGtDQUFrQyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUM7WUFDMUQsa0NBQWtDLEVBQUUsUUFBUTtTQUM3QyxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQTtRQUNsQixNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDO1lBQzdCLFNBQVMsRUFBRTtnQkFDVCxTQUFTLEVBQUUsQ0FBQztnQkFDWixTQUFTLEVBQUUsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDO2dCQUNqQixTQUFTLEVBQUUsUUFBUTthQUNwQjtTQUNGLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0FBRUosQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZWFkQ29uZmlnLCBnZXRBbGxDb25maWdMb2NhdGlvbnMsIGdldEFsbENvbmZpZ0ZpbGVzSW5EaXJlY3RvcnksIGZpbmRQYWNrYWdlUm9vdCwgbWVyZ2VDb25maWcsIHJlYWRDb25maWcsIHRvU25ha2VDYXNlIH0gZnJvbSAnLi9yZWFkQ29uZmlnJ1xuaW1wb3J0IHsgZXhpc3RzU3luYywgbWtkaXJTeW5jLCBybWRpclN5bmMgfSBmcm9tICdmcydcbmltcG9ydCB7IGpvaW4gfSBmcm9tICdwYXRoJ1xuXG5kZXNjcmliZSgnQ29uZmlnJywgKCkgPT4ge1xuXG4gIGNvbnN0IGNvbmZpZyA9IG5ldyBSZWFkQ29uZmlnKHtcbiAgICBhOiAxLFxuICAgIGI6IHtcbiAgICAgIGM6ICd0ZXN0MScsXG4gICAgICBkOiAndGVzdDInLFxuICAgIH0sXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ2dldCcsICgpID0+IHtcbiAgICBpdCgncmVhZHMgY29uZmlnIHZhbHVlcyByZWN1cnNpdmVseScsICgpID0+IHtcbiAgICAgIGV4cGVjdChjb25maWcuZ2V0KCdhJykpLnRvQmUoMSlcbiAgICAgIGV4cGVjdChjb25maWcuZ2V0KCdiJykpLnRvRXF1YWwoe2M6ICd0ZXN0MScsIGQ6ICd0ZXN0Mid9KVxuICAgICAgZXhwZWN0KGNvbmZpZy5nZXQoJ2IuYycpKS50b0JlKCd0ZXN0MScpXG4gICAgICBleHBlY3QoY29uZmlnLmdldCgnYi5kJykpLnRvQmUoJ3Rlc3QyJylcbiAgICB9KVxuICAgIGl0KCd0aHJvd3MgYW4gZXJyb3Igd2hlbiBrZXkgZG9lcyBub3QgZXhpc3QnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoKCkgPT4gY29uZmlnLmdldCgnZScpKS50b1Rocm93RXJyb3IoL2RvZXMgbm90IGV4aXN0LylcbiAgICAgIGV4cGVjdCgoKSA9PiBjb25maWcuZ2V0KCdlLmYnKSkudG9UaHJvd0Vycm9yKC9kb2VzIG5vdCBleGlzdC8pXG4gICAgfSlcbiAgICBpdCgncmV0dXJucyBhIGRlZmF1bHQgdmFsdWUgd2hlbiBwcm92aWRlZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChjb25maWcuZ2V0KCdiLmMnLCAndGVzdCcpKS50b0JlKCd0ZXN0MScpXG4gICAgICBleHBlY3QoY29uZmlnLmdldCgnZScsIDEpKS50b0JlKDEpXG4gICAgICBleHBlY3QoY29uZmlnLmdldCgnZS5mJywgMikpLnRvQmUoMilcbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCdoYXMnLCAoKSA9PiB7XG4gICAgaXQoJ3JldHVybnMgdHJ1ZSB3aGVuIGNvbmZpZyBwcm9wZXJ0eSBleGlzdHMsIGZhbHNlIG90aGVyd2lzZScsICgpID0+IHtcbiAgICAgIGV4cGVjdChjb25maWcuaGFzKCdhJykpLnRvQmUodHJ1ZSlcbiAgICAgIGV4cGVjdChjb25maWcuaGFzKCdiJykpLnRvQmUodHJ1ZSlcbiAgICAgIGV4cGVjdChjb25maWcuaGFzKCdiLmMnKSkudG9CZSh0cnVlKVxuICAgICAgZXhwZWN0KGNvbmZpZy5oYXMoJ2IuZCcpKS50b0JlKHRydWUpXG4gICAgICBleHBlY3QoY29uZmlnLmhhcygnZScpKS50b0JlKGZhbHNlKVxuICAgICAgZXhwZWN0KGNvbmZpZy5oYXMoJ2UuZicpKS50b0JlKGZhbHNlKVxuICAgIH0pXG4gIH0pXG5cbn0pXG5cbmRlc2NyaWJlKCdmaW5kUGFja2FnZVJvb3QnLCAoKSA9PiB7XG4gIGNvbnN0IGRpciA9IGpvaW4oX19kaXJuYW1lLCAncGFja2FnZS5qc29uJylcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgaWYgKGV4aXN0c1N5bmMoZGlyKSkge1xuICAgICAgcm1kaXJTeW5jKGRpcilcbiAgICB9XG4gICAgbWtkaXJTeW5jKGRpcilcbiAgfSlcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBpZiAoZXhpc3RzU3luYyhkaXIpKSB7XG4gICAgICBybWRpclN5bmMoZGlyKVxuICAgIH1cbiAgfSlcbiAgaXQoJ2ZpbmRzIHBhY2thZ2Ugcm9vdCBmb2xkZXInLCAoKSA9PiB7XG4gICAgZXhwZWN0KGZpbmRQYWNrYWdlUm9vdCgpKS50b0VxdWFsKGphc21pbmUuYW55KFN0cmluZykpXG4gIH0pXG4gIGl0KCdmaW5kcyBwYWNrYWdlIHJvb3QgZm9sZGVyJywgKCkgPT4ge1xuICAgIGV4cGVjdChmaW5kUGFja2FnZVJvb3QoX19kaXJuYW1lKSkudG9FcXVhbChqYXNtaW5lLmFueShTdHJpbmcpKVxuICB9KVxuICBpdCgndGhyb3dzIGFuIGVycm9yIHdoZW4gbm90IGZvdW5kJywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiBmaW5kUGFja2FnZVJvb3QoJy90bXAnKSkudG9UaHJvd0Vycm9yKClcbiAgfSlcbn0pXG5cbmRlc2NyaWJlKCdnZXRBbGxDb25maWdGaWxlc0luRGlyZWN0b3J5JywgKCkgPT4ge1xuICBpdCgncmV0dXJucyBkZWZhdWx0IGFuZCBsb2NhbCBmaWxlcycsICgpID0+IHtcbiAgICBjb25zdCBmaWxlcyA9IGdldEFsbENvbmZpZ0ZpbGVzSW5EaXJlY3RvcnkoJy90ZXN0JywgdW5kZWZpbmVkKVxuICAgIGV4cGVjdChmaWxlcykudG9FcXVhbChbXG4gICAgICAnL3Rlc3QvZGVmYXVsdC55YW1sJyxcbiAgICAgICcvdGVzdC9sb2NhbC55YW1sJyxcbiAgICBdKVxuICB9KVxuICBpdCgncmV0dXJucyBkZWZhdWx0LCBlbnZpcm9ubWVudCwgYW5kIGxvY2FsIGZpbGVzJywgKCkgPT4ge1xuICAgIGNvbnN0IGZpbGVzID0gZ2V0QWxsQ29uZmlnRmlsZXNJbkRpcmVjdG9yeSgnL3Rlc3QnLCAndGVzdCcpXG4gICAgZXhwZWN0KGZpbGVzKS50b0VxdWFsKFtcbiAgICAgICcvdGVzdC9kZWZhdWx0LnlhbWwnLFxuICAgICAgJy90ZXN0L3Rlc3QueWFtbCcsXG4gICAgICAnL3Rlc3QvbG9jYWwueWFtbCcsXG4gICAgXSlcbiAgfSlcbn0pXG5cbmRlc2NyaWJlKCdnZXRBbGxDb25maWdMb2NhdGlvbnMnLCAoKSA9PiB7XG4gIGl0KCdyZXR1cm5zIHBhY2thZ2UgYW5kIGxvY2FsIGRpcnMgd2hlbiBzZXBhcmF0ZScsICgpID0+IHtcbiAgICBjb25zdCBmaWxlcyA9IGdldEFsbENvbmZpZ0xvY2F0aW9ucygnL3Rlc3QxJywgJy90ZXN0MicsICd0ZXN0JylcbiAgICBleHBlY3QoZmlsZXMpLnRvRXF1YWwoW1xuICAgICAgJy90ZXN0MS9kZWZhdWx0LnlhbWwnLFxuICAgICAgJy90ZXN0MS90ZXN0LnlhbWwnLFxuICAgICAgJy90ZXN0MS9sb2NhbC55YW1sJyxcbiAgICAgICcvdGVzdDIvZGVmYXVsdC55YW1sJyxcbiAgICAgICcvdGVzdDIvdGVzdC55YW1sJyxcbiAgICAgICcvdGVzdDIvbG9jYWwueWFtbCcsXG4gICAgXSlcbiAgfSlcblxuICBpdCgncmV0dXJucyBvbmx5IHBhY2thZ2UgZGlyIHdoZW4gbG9jYWwgZGlyIGlzIHNhbWUnLCAoKSA9PiB7XG4gICAgY29uc3QgZmlsZXMgPSBnZXRBbGxDb25maWdMb2NhdGlvbnMoJy90ZXN0JywgJy90ZXN0JywgJ3Rlc3QnKVxuICAgIGV4cGVjdChmaWxlcykudG9FcXVhbChbXG4gICAgICAnL3Rlc3QvZGVmYXVsdC55YW1sJyxcbiAgICAgICcvdGVzdC90ZXN0LnlhbWwnLFxuICAgICAgJy90ZXN0L2xvY2FsLnlhbWwnLFxuICAgIF0pXG4gIH0pXG4gIGl0KCdhZGRzIGFuIGV4dHJhIGNvbmZpZyBmaWxlJywgKCkgPT4ge1xuICAgIGNvbnN0IGZpbGVzID0gZ2V0QWxsQ29uZmlnTG9jYXRpb25zKFxuICAgICAgJy90ZXN0JywgJy90ZXN0JywgJ3Rlc3QnLCAnL3Rlc3QvdGVzdC1leHRyYS55YW1sJylcbiAgICBleHBlY3QoZmlsZXMpLnRvRXF1YWwoW1xuICAgICAgJy90ZXN0L2RlZmF1bHQueWFtbCcsXG4gICAgICAnL3Rlc3QvdGVzdC55YW1sJyxcbiAgICAgICcvdGVzdC9sb2NhbC55YW1sJyxcbiAgICAgICcvdGVzdC90ZXN0LWV4dHJhLnlhbWwnLFxuICAgIF0pXG4gIH0pXG4gIGl0KCdkb2VzIG5vdCBhZGQgZXh0cmEgY29uZmlnIGZpbGUgd2hlbiBpdCBpcyB0aGUgc2FtZScsICgpID0+IHtcbiAgICBjb25zdCBmaWxlcyA9IGdldEFsbENvbmZpZ0xvY2F0aW9ucyhcbiAgICAgICcvdGVzdCcsICcvdGVzdCcsICd0ZXN0JywgJy90ZXN0L3Rlc3QueWFtbCcpXG4gICAgZXhwZWN0KGZpbGVzKS50b0VxdWFsKFtcbiAgICAgICcvdGVzdC9kZWZhdWx0LnlhbWwnLFxuICAgICAgJy90ZXN0L3Rlc3QueWFtbCcsXG4gICAgICAnL3Rlc3QvbG9jYWwueWFtbCcsXG4gICAgXSlcbiAgfSlcbn0pXG5cbmRlc2NyaWJlKCd0b1NuYWtlQ2FzZScsICgpID0+IHtcbiAgaXQoJ2NvbnZlcnRzIHVwcGVyY2FzZSwgdW5kZXJzY29yZS1zZXBhcmF0ZWQgd29yZHMgdG8gc25ha2UgY2FzZScsICgpID0+IHtcbiAgICBleHBlY3QodG9TbmFrZUNhc2UoJ1RFU1QnKSkudG9CZSgndGVzdCcpXG4gICAgZXhwZWN0KHRvU25ha2VDYXNlKCdURVNUXzEnKSkudG9CZSgndGVzdDEnKVxuICAgIGV4cGVjdCh0b1NuYWtlQ2FzZSgnVEVTVF9WQUxVRScpKS50b0JlKCd0ZXN0VmFsdWUnKVxuICAgIGV4cGVjdCh0b1NuYWtlQ2FzZSgnVEVTVF9WQUxVRV9UV08nKSkudG9CZSgndGVzdFZhbHVlVHdvJylcbiAgfSlcbn0pXG5cbmRlc2NyaWJlKCdtZXJnZUNvbmZpZycsICgpID0+IHtcbiAgaXQoJ21lcmdlcyBzb3VyY2UgY29uZmlnIGludG8gZGVzdGluYXRpb24nLCAoKSA9PiB7XG4gICAgY29uc3QgZGVzdCA9IHtcbiAgICAgIGE6IDEsXG4gICAgICBiOiBbMl0sXG4gICAgICBjOiB7XG4gICAgICAgIGQ6IDMsXG4gICAgICB9LFxuICAgIH1cbiAgICBleHBlY3QobWVyZ2VDb25maWcoe1xuICAgICAgYTogNCxcbiAgICAgIGI6IHt2YWx1ZTogNX0sXG4gICAgICBjOiB7XG4gICAgICAgIGU6IDYsXG4gICAgICB9LFxuICAgIH0sIGRlc3QpKS50b0VxdWFsKHtcbiAgICAgIGE6IDQsXG4gICAgICBiOiB7dmFsdWU6IDV9LFxuICAgICAgYzoge1xuICAgICAgICBkOiAzLFxuICAgICAgICBlOiA2LFxuICAgICAgfSxcbiAgICB9KVxuICB9KVxufSlcblxuZGVzY3JpYmUoJ3JlYWRDb25maWcnLCAoKSA9PiB7XG5cbiAgaXQoJ3JlYWRzIGZyb20gYSBudW1iZXIgb2YgZmlsZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gcmVhZENvbmZpZygpXG4gICAgZXhwZWN0KHJlc3VsdCkudG9CZUluc3RhbmNlT2YoUmVhZENvbmZpZylcbiAgfSlcblxuICBpdCgncmVhZHMgZnJvbSBhbiBleHRyYSBjb25maWcgZmlsZScsICgpID0+IHtcbiAgfSlcblxuICBkZXNjcmliZSgnZXJyb3JzJywgKCkgPT4ge1xuICAgIGNvbnN0IGRpciA9IGpvaW4oX19kaXJuYW1lLCAndGVzdC5kaXInKVxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgbWtkaXJTeW5jKGRpcilcbiAgICB9KVxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgICBybWRpclN5bmMoZGlyKVxuICAgIH0pXG4gICAgaXQoJ2ZhaWxzIG9uIGVycm9ycyBkaWZmZXJlbnQgdGhhbiBFTk9FTlQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoKCkgPT4gcmVhZENvbmZpZyhcbiAgICAgICAgcHJvY2Vzcy5lbnYsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICBkaXIsXG4gICAgICApKS50b1Rocm93RXJyb3IoL0VJU0RJUi8pXG4gICAgfSlcbiAgfSlcblxuICBpdCgnZG9lcyBub3QgZmFpbCB3aGVuIG5vIGNvbmZpZyBmaWxlcyBmb3VuZCcsICgpID0+IHtcbiAgICByZWFkQ29uZmlnKHt9LCAnL3RtcCcsICcvdG1wJylcbiAgfSlcblxuICBpdCgncmVhZHMgdmFsdWVzIGZyb20gZW52aXJvbm1lbnQgdmFyaWFibGVzJywgKCkgPT4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IHJlYWRDb25maWcoe1xuICAgICAgUEVFUkNBTExTX19URVNUX1ZBTFVFX19TVUJfVkFMVUVfMTogJzEnLFxuICAgICAgUEVFUkNBTExTX19URVNUX1ZBTFVFX19TVUJfVkFMVUVfMjogSlNPTi5zdHJpbmdpZnkoe2E6IDJ9KSxcbiAgICAgIFBFRVJDQUxMU19fVEVTVF9WQUxVRV9fU1VCX1ZBTFVFXzM6ICdzdHJpbmcnLFxuICAgIH0sICcvdG1wJywgJy90bXAnKVxuICAgIGV4cGVjdChjb25maWcudmFsdWUoKSkudG9FcXVhbCh7XG4gICAgICB0ZXN0VmFsdWU6IHtcbiAgICAgICAgc3ViVmFsdWUxOiAxLFxuICAgICAgICBzdWJWYWx1ZTI6IHthOiAyfSxcbiAgICAgICAgc3ViVmFsdWUzOiAnc3RyaW5nJyxcbiAgICAgIH0sXG4gICAgfSlcbiAgfSlcblxufSlcbiJdfQ==